module.exports = initUser;

function initUser(Name,password){
    var config = this.config;

    var sql = 'SELECT count(ID) FROM PersonalInformation';

    config.modules['saferman'].sql(sql,function(results){
        var NextUsableID = results[0]['count(ID)'] + 1;

        initRightsManagement(NextUsableID);
        initPersonalInformation(NextUsableID);
        initShadowTable(NextUsableID);



        function initRightsManagement(NextUsableID){
            config.modules['rights_management'].initRightsOfUser(NextUsableID);
        }

        function initPersonalInformation(NextUsableID){
            var sql = 'INSERT INTO PersonalInformation (ID,Name) VALUE (' + NextUsableID + ",'" + Name + "')";
            config.modules['saferman'].sql(sql);
        }

        function initShadowTable(NextUsableID){
            var sql = 'INSERT INTO ShadowTable (ID,Shadow) VALUE (' + NextUsableID + ",'" + password + "')";
            config.modules['saferman'].sql(sql);
        }
    });
}

